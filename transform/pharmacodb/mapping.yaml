class: GraphMap

schema: ../../src/bmeg/bmeg-dictionary/gdcdictionary/schemas


ruleMap:
  - name: "*.project.json.gz"
    rule: project
  - name: "*.case.json.gz"
    rule: case
  - name: "*.sample.json.gz"
    rule: sample
  - name: "*.aliquot.json.gz"
    rule: aliquot
  - name: "*.drug_response.json.gz"
    rule: drug_response

rules:
  project:
    filePrefix: '{{split-select inputs.basename "." 0}}'
    idPrefix: Project
    idField: submitter_id
    label: Project
    class: project
    outEdges:
      compounds:
        toPrefix: Compound
        idTemplate: "{{row._from}}--{{row._label}}--{{row._to}}"
    inEdges:
      projects:
        fromPrefix: Compound
        idTemplate: "{{row._from}}--{{row._label}}--{{row._to}}"

  case:
    filePrefix: '{{split-select inputs.basename "." 0}}'
    idPrefix: Case
    idField: submitter_id
    label: Case
    class: case
    outEdges:
      samples:
        toPrefix: Sample
        idTemplate: "{{row._from}}--{{row._label}}--{{row._to}}"
      projects:
        toPrefix: Project
        idTemplate: "{{row._from}}--{{row._label}}--{{row._to}}"
    inEdges:
      cases:
        fromPrefix: Project
        idTemplate: "{{row._from}}--{{row._label}}--{{row._to}}"

  sample:
    filePrefix: '{{split-select inputs.basename "." 0}}'
    idPrefix: Sample
    idField: submitter_id
    label: Sample
    class: sample
    outEdges:
      case:
        toPrefix: "Case"
        idTemplate: "{{row._from}}--{{row._label}}--{{row._to}}"
    inEdges:
      samples:
        fromPrefix: "Case"
        idTemplate: "{{row._from}}--{{row._label}}--{{row._to}}"

  aliquot:
    filePrefix: '{{split-select inputs.basename "." 0}}'
    idPrefix: Aliquot
    idField: submitter_id
    label: Aliquot
    class: aliquot
    outEdges:
      sample:
        toPrefix: Sample
        idTemplate: "{{row._from}}--{{row._label}}--{{row._to}}"
    inEdges:
      aliquots:
        fromPrefix: Sample
        idTemplate: "{{row._from}}--{{row._label}}--{{row._to}}"

  drug_response:
    filePrefix: '{{split-select inputs.basename "." 0}}'
    idPrefix: DrugResponse
    idField: submitter_id
    label: DrugResponse
    class: drug_response
    outEdges:
      compounds:
        toPrefix: Compound
        idTemplate: "{{row._from}}--{{row._label}}--{{row._to}}"
      aliquot:
        toPrefix: Aliquot
    inEdges:
      drug_response:
        fromPrefix: Aliquot
        idTemplate: "{{row._from}}--{{row._label}}--{{row._to}}"
      drug_responses:
        fromPrefix: Compound
        idTemplate: "{{row._from}}--{{row._label}}--{{row._to}}"
